---
description: 시그니처/API 변경 시 연관 코드 누락 방지
alwaysApply: true
---

# 코드 변경 시 연관 수정 체크리스트

## 1. 메서드/API 시그니처 변경 시

- **공용 매퍼·서비스·API**의 시그니처를 바꾸면 **모든 호출부**를 반드시 찾아서 수정한다.
- 변경 후 `grep`(또는 코드 검색)으로 호출처를 전부 확인한다.
  - 예: `toResponseDto`, `postMapper::toResponseDto` → 매퍼 시그니처 변경 시 PostService 외 **TagService, CategoryService** 등 사용처 모두 수정.

## 2. MapStruct – 다중 파라미터 매핑

- 메서드에 파라미터가 2개 이상이면, `source`는 **어느 파라미터**에서 오는지 명시한다.
- 예: `toResponseDto(Post post, long commentCount)` 일 때
  - ❌ `source = "category"` (어느 파라미터인지 불명확 → 컴파일 에러)
  - ✅ `source = "post.category"`, `source = "post.tags"`
  - ✅ `target = "commentCount"` 는 `expression = "java(commentCount)"` 등으로 두 번째 파라미터 사용.

## 3. DTO/응답 구조 변경 시

- 응답 DTO에 필드를 추가하면, **그 DTO를 채워서 반환하는 모든 경로**를 수정한다.
- 예: `PostResponseDto`에 `commentCount` 추가 시
  - PostService (목록/상세/생성/수정/발행)
  - **TagService** (태그별 게시글 목록)
  - **CategoryService** (카테고리별 게시글 목록)
  - 새 의존성(예: CommentRepository)이 필요하면 위 서비스들에 주입·사용 추가.

## 4. 리스트/배열이 비었을 때

- `IN (:ids)` 형태의 쿼리(예: `countByPostIds`)에 **빈 리스트**를 넘기지 않는다.  
  목록이 비었으면 쿼리 호출 전에 early return 하거나, 빈 결과를 그대로 반환한다.
